# ============================================================================
# CortexDx Environment Configuration
# ============================================================================
# Copy this file to .env and configure your values
# Most variables are optional and have sensible defaults

# ============================================================================
# Core Server Configuration
# ============================================================================

# Server host and port
# Default: 127.0.0.1:5001
HOST=127.0.0.1
PORT=5001

# Node environment (development, production, test)
NODE_ENV=development

# Base URL for the CortexDx API
CORTEXDX_BASE_URL=http://localhost:5001

# ============================================================================
# Authentication & Authorization
# ============================================================================

# Auth0 Configuration (OAuth/OIDC)
AUTH0_DOMAIN=your-tenant.auth0.com
AUTH0_CLIENT_ID=your-client-id
AUTH0_AUDIENCE=https://your-api-identifier

# CortexDx-specific Auth0 configuration
CORTEXDX_AUTH0_DOMAIN=your-tenant.auth0.com
CORTEXDX_AUTH0_CLIENT_ID=your-client-id
CORTEXDX_AUTH0_CLIENT_SECRET=your-client-secret
CORTEXDX_AUTH0_AUDIENCE=https://your-api-identifier
CORTEXDX_AUTH0_SCOPE=openid profile email
CORTEXDX_AUTH0_DEVICE_CODE=false
CORTEXDX_AUTH0_DEVICE_CODE_ENDPOINT=https://your-tenant.auth0.com/oauth/device/code

# API Keys and Tokens
CORTEXDX_API_KEY=your-api-key
CORTEXDX_BEARER_TOKEN=your-bearer-token
CORTEXDX_ADMIN_TOKEN=your-admin-token

# Internal API authentication
CORTEXDX_INTERNAL_ENDPOINT=http://localhost:5001
CORTEXDX_INTERNAL_AUTH_HEADER=x-cortexdx-internal
CORTEXDX_INTERNAL_HEADERS={}

# Authentication enforcement
REQUIRE_AUTH=false
REQUIRE_LICENSE=false

# Cloudflare Access (Zero Trust)
CF_ACCESS_CLIENT_ID=your-cf-access-client-id
CF_ACCESS_CLIENT_SECRET=your-cf-access-client-secret

# Cloudflare Tunnel Configuration
# Use either token-based or config file-based authentication
# Token-based (recommended): Set ONLY ONE of the following tokens.
# If both are set, CLOUDFLARE_TUNNEL_TOKEN takes precedence.
# Uncomment and set ONE of these:
# CLOUDFLARE_TUNNEL_TOKEN=your-cloudflare-tunnel-token
# CORTEXDX_CLOUDFLARED_TOKEN=your-cloudflare-tunnel-token
# Config file-based: Configure ~/.cloudflared/config.yml and set CORTEXDX_CLOUDFLARED_TUNNEL
CORTEXDX_CLOUDFLARED_TUNNEL=your-tunnel-name
CORTEXDX_CLOUDFLARED_CONFIG=~/.cloudflared/config.yml
CORTEXDX_CLOUDFLARED_HEALTH_URLS=https://cortexdx.brainwav.io/health

# CORS Configuration
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5001

# ============================================================================
# LLM / AI Configuration
# ============================================================================

# LLM Provider selection
LLM_PROVIDER=ollama

# Enable/disable local and cloud LLM
CORTEXDX_ENABLE_LOCAL_LLM=true
CORTEXDX_ENABLE_CLOUD_LLM=false
CORTEXDX_FORCE_OLLAMA=true

# LLM priority order (comma-separated: ollama,openai,anthropic)
CORTEXDX_LLM_PRIORITY=ollama,openai

# Ollama Configuration
CORTEXDX_OLLAMA_ENDPOINT=http://localhost:11434

# Cloud LLM Configuration
CORTEXDX_CLOUD_LLM_MODEL=gpt-4
CORTEXDX_CLOUD_OLLAMA_BASE_URL=https://api.openai.com/v1
CORTEXDX_CLOUD_OLLAMA_API_KEY=your-openai-api-key

# ============================================================================
# External API Keys & Services
# ============================================================================

# Academic Research APIs
OPENALEX_CONTACT_EMAIL=your-email@example.com
OPENALEX_THROTTLE_MS=100
SEMANTIC_SCHOLAR_API_KEY=your-semantic-scholar-api-key

# Search & Retrieval
EXA_API_KEY=your-exa-api-key
JINA_API_KEY=your-jina-api-key
WILDCARD_API_KEY=your-wildcard-api-key

# Vector Database
TURBOPUFFER_API_KEY=your-turbopuffer-api-key

# Context7 Integration
CONTEXT7_API_KEY=your-context7-api-key
CONTEXT7_API_BASE_URL=https://api.context7.com
CONTEXT7_PROFILE=default

# Cortex Vibe (VibeCheck) Integration
CORTEX_VIBE_API_BASE_URL=https://api.cortex-vibe.com
CORTEX_VIBE_HTTP_URL=https://api.cortex-vibe.com
VIBE_CHECK_API_KEY=your-vibecheck-api-key
VIBE_CHECK_HTTP_URL=https://api.vibecheck.com
VIBE_CHECK_PROFILE=default
VIBE_CHECK_STRICT=false

# MCP (Model Context Protocol) Configuration
CORTEXDX_MCP_API_KEY=your-mcp-api-key
CORTEXDX_MANIFESTS_JSON=./manifests.json

# ============================================================================
# Cloud Storage Configuration
# ============================================================================

# Cloud Provider: r2, s3, gcs, or leave empty for local storage only
CORTEXDX_CLOUD_PROVIDER=

# Cloudflare R2 Configuration
CLOUDFLARE_ACCOUNT_ID=your-account-id
R2_BUCKET_NAME=cortexdx-reports
R2_ACCESS_KEY_ID=your-r2-access-key-id
R2_SECRET_ACCESS_KEY=your-r2-secret-access-key
R2_PUBLIC_DOMAIN=

# AWS S3 Configuration
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key

# Generic Cloud Storage
CORTEXDX_CLOUD_ENDPOINT=
CORTEXDX_CLOUD_BUCKET=cortexdx-reports
CORTEXDX_CLOUD_REGION=us-east-1
CORTEXDX_CLOUD_ENV_FILE=.env

# ============================================================================
# Report Configuration
# ============================================================================

# Report storage and generation
CORTEXDX_REPORT_DIR=./reports
CORTEXDX_REPORT_URL=http://localhost:5001/reports
CORTEXDX_REPORT_PREFIX=reports/
CORTEXDX_REPORT_TTL_SECONDS=900
CORTEXDX_REPORT_RETENTION_DAYS=30
CORTEXDX_REPORT_FORMATS=json,html,md
CORTEXDX_REPORT_STRATEGY=local
CORTEXDX_REPORT_COMPRESSION=true

# ============================================================================
# DeepContext & Code Analysis
# ============================================================================

# DeepContext configuration
CORTEXDX_DEEPCONTEXT_STATE=enabled
CORTEXDX_DISABLE_DEEPCONTEXT=false

# Project analysis
CORTEXDX_PROJECT_ROOT=.
CORTEXDX_WORKSPACE_ROOT=.
CORTEXDX_PROJECT_TYPE=typescript
CORTEXDX_PROJECT_LANGUAGE=typescript
CORTEXDX_CODEX_CONTEXT_DIR=.cortexdx/context
CODEX_CONTEXT_DIR=.cortexdx/context

# ============================================================================
# State & Pattern Storage
# ============================================================================

# State database
CORTEXDX_STATE_DIR=./.cortexdx/state
CORTEXDX_STATE_DB=./.cortexdx/state/cortexdx.db

# Pattern storage with encryption
CORTEXDX_PATTERN_DB=./.cortexdx/patterns/patterns.db
CORTEXDX_PATTERN_KEY=your-32-character-encryption-key

# ============================================================================
# Security Features
# ============================================================================

# Security enforcement
CORTEXDX_ENFORCE_SECURITY=false
CORTEXDX_ENABLE_ZAP=false

# OWASP ZAP Integration
ZAP_API_URL=http://localhost:8080

# Dependency Track Integration
CORTEXDX_DT_API_URL=https://dependencytrack.example.com
CORTEXDX_DT_API_KEY=your-dt-api-key
CORTEXDX_DT_PROJECT=your-project-id
CORTEXDX_DT_PROJECT_VERSION=1.0.0

# Semgrep binary path (optional, will use npx if not set)
SEMGREP_BIN=/usr/local/bin/semgrep

# ============================================================================
# Timeout Configuration (milliseconds)
# ============================================================================

# Global timeout
GLOBAL_TIMEOUT=30000
CORTEXDX_GLOBAL_TIMEOUT=30000

# Component-specific timeouts
TIMEOUT_HANDSHAKE=5000
TIMEOUT_INSPECTOR=10000
TIMEOUT_EMBEDDING=15000
TIMEOUT_OLLAMA=30000
TIMEOUT_HTTP_MCP_CLIENT=10000
TIMEOUT_STDIO_WRAPPER=10000
TIMEOUT_HUMAN_IN_LOOP=300000
TIMEOUT_PLUGIN_ORCHESTRATOR=60000
TIMEOUT_PROBLEM_RESOLVER=30000
TIMEOUT_INTEGRATION_TEST=30000

# CortexDx-prefixed timeouts (aliases)
CORTEXDX_TIMEOUT_HANDSHAKE=5000
CORTEXDX_TIMEOUT_INSPECTOR=10000
CORTEXDX_TIMEOUT_EMBEDDING=15000
CORTEXDX_TIMEOUT_OLLAMA=30000
CORTEXDX_TIMEOUT_HTTP_MCP_CLIENT=10000
CORTEXDX_TIMEOUT_STDIO_WRAPPER=10000
CORTEXDX_TIMEOUT_HUMAN_IN_LOOP=300000
CORTEXDX_TIMEOUT_PLUGIN_ORCHESTRATOR=60000
CORTEXDX_TIMEOUT_PROBLEM_RESOLVER=30000
CORTEXDX_TIMEOUT_INTEGRATION_TEST=30000

# ============================================================================
# Inspector & Diagnostic Configuration
# ============================================================================

# Inspector settings
INSPECTOR_MAX_RUNTIME_MS=10000
CORTEXDX_INSPECTOR_MAX_RUNTIME_MS=10000
CORTEXDX_INSPECTOR_PROXY_PORT=0
CORTEXDX_INSPECTOR_VERBOSE=false

# ============================================================================
# Service Feature Toggles
# ============================================================================

# Disable specific HTTP integrations
CORTEXDX_DISABLE_SSE=false
CORTEXDX_DISABLE_CONTEXT7_HTTP=false
CORTEXDX_DISABLE_CORTEX_VIBE_HTTP=false
CORTEXDX_DISABLE_OPENALEX_HTTP=false
CORTEXDX_DISABLE_SEMANTIC_SCHOLAR_HTTP=false
CORTEXDX_DISABLE_VIBECHECK_HTTP=false

# SSE (Server-Sent Events) endpoint
CORTEXDX_SSE_ENDPOINT=http://localhost:5001/events

# Self-healing endpoint
CORTEXDX_SELF_HEALING_ENDPOINT=http://localhost:5001/self-healing

# ============================================================================
# Monitoring & Telemetry
# ============================================================================

# Monitoring
ENABLE_MONITORING=true
CORTEXDX_MONITOR_STATE=enabled
MONITORING_INTERVAL_MS=60000

# Telemetry
CORTEXDX_TELEMETRY_ENABLED=true
SHINZO_TELEMETRY_TOKEN=your-shinzo-telemetry-token

# ============================================================================
# Rate Limiting & Billing
# ============================================================================

# Rate limiting tiers
DEFAULT_TIER=free
CORTEXDX_DEFAULT_RATE_LIMIT_TIER=free

# ============================================================================
# TLS/SSL Configuration
# ============================================================================

# TLS certificate paths (for HTTPS server)
CORTEXDX_TLS_CERT_PATH=./certs/server.crt
CORTEXDX_TLS_KEY_PATH=./certs/server.key

# ============================================================================
# Artifacts & Output
# ============================================================================

# Artifacts storage directory
CORTEXDX_ARTIFACTS=./artifacts

# ============================================================================
# Logging
# ============================================================================

# Log level: trace, debug, info, warn, error, fatal
CORTEXDX_LOG_LEVEL=info

# ============================================================================
# CI/CD Integration
# ============================================================================

# GitHub Actions integration
GITHUB_SHA=
GITHUB_REF=

# ============================================================================
# Development & Testing
# ============================================================================

# Test mode
VITEST=false
CORTEXDX_RUN_INTEGRATION=0

# Initial working directory (usually set by package manager)
INIT_CWD=

# System paths (usually auto-detected)
LOCALAPPDATA=
XDG_DATA_HOME=

# ============================================================================
# Notes
# ============================================================================
#
# 1. Most variables are optional and have sensible defaults
# 2. Set CORTEXDX_PATTERN_KEY to a random 32-character string for encryption
# 3. For Auth0, create an application at https://manage.auth0.com/
# 4. For cloud storage, choose ONE provider (R2, S3, or GCS)
# 5. Set NODE_ENV=production for production deployments
# 6. Adjust timeouts based on your network and system performance
# 7. Enable telemetry to help improve CortexDx (optional)
#
# For more information, see: https://cortexdx.dev/docs/configuration
#
